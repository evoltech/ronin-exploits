require 'spec_helper'

shared_examples_for "an Exploit" do
  it "should set the name property" do
    @exploit.name.should == Gen::Exploits::Exploit::DEFAULT_NAME
  end

  it "should set the description property" do
    @exploit.description.should == Gen::Exploits::Exploit::DEFAULT_DESCRIPTION
  end

  it "should set the status property" do
    @exploit.status.should == Gen::Exploits::Exploit::DEFAULT_STATUS
  end

  it "should set the disclosure property" do
    @exploit.disclosure.include?(:in_wild).should == true
  end

  it "should defines an author" do
    @exploit.authors.length.should == 1
    @exploit.authors.first.name.should == Author::ANONYMOUSE
  end

  it "should define control methods" do
    @exploit.respond_to?(:code_exec).should == true
  end
end
