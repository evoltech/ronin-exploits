require 'ronin/translators/xor'

require 'spec_helper'

describe Ronin do
  describe Translators::XOR do
    before(:all) do
      @data = "\x00\x01\x90ABC123[]{}'"
    end

    it "should encode-out unwanted characters" do
      disallow = [0x00, 0x01, 0x90]
      xor = Translators::XOR.new(:disallow => disallow)

      xor.encode(@data).each_byte do |b|
        disallow.include?(b).should_not == true
      end
    end

    it "should decode XOR encoded data" do
      xor = Translators::XOR.new

      xor.decode(xor.encode(@data)).should == @data
    end
  end
end
