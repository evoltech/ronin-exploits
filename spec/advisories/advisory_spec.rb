require 'spec_helper'
require 'ronin/advisories/advisory'

describe Advisories::Advisory do
  let(:publisher) { 'CVE' }
  let(:number) { '2011-1234' }

  subject do
    described_class.new(:publisher => publisher, :number => number)
  end

  describe "#to_s" do
    it "should join the publisher and number" do
      subject.to_s.should == "#{publisher}-#{number}"
    end
  end

  describe "#to_ary" do
    it "should splat the publisher and number" do
      pub, num = subject

      pub.should == publisher
      num.should == number
    end
  end

  describe "#inspect" do
    it "should include the class, publisher and number" do
      subject.inspect.should == "#<#{described_class}: #{publisher}-#{number}>"
    end
  end
end
