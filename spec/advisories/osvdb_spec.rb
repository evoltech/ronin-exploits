require 'spec_helper'
require 'ronin/advisories/osvdb'

describe Advisories::OSVDB do
  let(:number) { 1234 }
  let(:advisory) { described_class.new(:number => number) }

  subject { advisory }

  it "should default publisher to 'OSVDB'" do
    subject.publisher.should == 'OSVDB'
  end

  describe "#url" do
    subject { advisory.url }

    its(:scheme) { should == 'https' }
    its(:host)   { should == 'osvdb.org' }

    it "should embed the number into the path" do
      subject.path.should == "/show/osvdb/#{number}"
    end
  end
end
