require 'ronin/vulnerability/tests'

require 'spec_helper'

describe Vulnerability::Tests do
  before(:all) do
    class Vuln

      include Vulnerability::Tests

      vulnerable_to :test => :test1
      vulnerable_to :test_two => :test2

      def test1(options={})
        'test one'
      end

      def test2(options={})
        'test two'
      end

    end
  end

  it "should mark classes as being vulnerable" do
    Vuln.vulnerable_to?(:test).should == true
  end

  it "should have a hash of vuln names and test methods" do
    Vuln.vulns[:test].should == :test1
    Vuln.vulns[:test_two].should == :test2
  end

  it "should return the results of the vuln test methods for an object" do
    obj = Vuln.new

    obj.vulns.should == {:test => 'test one', :test_two => 'test two'}
  end
end
