require 'spec_helper'
require 'ronin/exploits/web'

describe Exploits::Web do
  describe "targeted_url" do
    it "should initialize all parameters by default" do
      exploit = described_class.new
      
      exploit.params.should_not be_empty
    end

    it "should create a targeted URL using the host param" do
      host = 'www.example.com'
      exploit = described_class.new(:host => host)

      exploit.targeted_url.host.should == host
    end

    it "should create a targeted URL using the host param and the url_path property" do
      host = 'www.example.com'
      path = '/'
      exploit = described_class.new(:host => host, :url_path => path)

      exploit.targeted_url.host.should == host
      exploit.targeted_url.path.should == path
    end

    it "should raise a MissingParam exception if host params is missing" do
      exploit = described_class.new(:url_path => '/')

      lambda { exploit.targeted_url }.should raise_error(Parameters::MissingParam)
    end
  end
end
