require 'spec_helper'
require 'ronin/exploits/behavior'

describe Exploits::Behavior do
  subject do
    described_class.new(
      :name => 'test',
      :description => 'This is a test.'
    )
  end

  it "should require name and description attributes" do
    behavior = described_class.new
    behavior.should_not be_valid

    behavior.name = 'arbitrary lol injection'
    behavior.should_not be_valid

    behavior.description = %{Allows for the arbitrary injection of lolz.}
    behavior.should be_valid
  end

  it "should be able to convert to a String" do
    subject.to_s.should == 'test'
  end

  it "should be able to convert to a Symbol" do
    subject.to_sym.should == :test
  end
end
