require 'spec_helper'
require 'ronin/exploits/local'
require 'ronin/exploits/helpers/format_string'

describe Exploits::Helpers::FormatString do
  before(:all) do
    @exploit = ronin_local_exploit do
      helper :format_string

      targeting do |target|
        target.arch = Arch.i686
        target.pop_length = 256
        target.overwrite = 0xffffaaaa
        target.address = 0xffffbbbb
      end

      build { @format_string = build_format_string }
    end
  end

  it "should build a format string" do
    @exploit.target = @exploit.targets[0]
    @exploit.build!

    @exploit.format_string.should_not be_nil
  end
end
