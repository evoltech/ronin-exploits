require 'spec_helper'
require 'ronin/exploits/local'
require 'ronin/exploits/helpers/padding'

describe Exploits::Helpers::Padding do
  subject do
    Exploits::Local.object do
      helper :padding

      def pad_buffer
        pad(1024)
      end

      def pad_data_left
        pad_left('hello',1024)
      end

      def pad_data_right
        pad_right('hello',1024)
      end
    end
  end

  it "should pad a buffer" do
    buffer = subject.pad_buffer

    buffer.length.should == 1024
  end

  it "should pad a buffer with data to the left" do
    buffer = subject.pad_data_left

    buffer.length.should == 1024
    (buffer =~ /hello$/).should_not be_nil
  end

  it "should pad a buffer with data to the right" do
    buffer = subject.pad_data_right

    buffer.length.should == 1024
    (buffer =~ /^hello/).should_not be_nil
  end
end
