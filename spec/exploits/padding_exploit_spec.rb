require 'ronin/exploits/local'
require 'ronin/exploits/helpers/padding'

require 'spec_helper'

describe Exploits::Helpers::Padding do
  before(:all) do
    @exploit = Exploits::Local.new do
      extend Exploits::Helpers::Padding

      def pad_buffer
        pad(1024)
      end

      def pad_data_left(data)
        pad_left(data,1024)
      end

      def pad_data_right(data)
        pad_right(data,1024)
      end
    end
  end

  it "should pad a buffer" do
    buffer = @exploit.pad_buffer

    buffer.length.should == 1024
  end

  it "should pad a buffer with data to the left" do
    buffer = @exploit.pad_data_left('hello')

    buffer.length.should == 1024
    (buffer =~ /hello$/).should_not be_nil
  end

  it "should pad a buffer with data to the right" do
    buffer = @exploit.pad_data_right('hello')

    buffer.length.should == 1024
    (buffer =~ /^hello/).should_not be_nil
  end
end
