require 'spec_helper'
require 'ronin/exploits/remote_tcp'

describe Exploits::RemoteTCP do
  subject do
    described_class.new(
      :default_port => 22,
      :host => '127.0.0.1'
    )
  end

  it "should include the TCP Network helper module" do
    described_class.should < Network::Mixins::TCP
  end

  it "should initialize all parameters by default" do
    subject.params.should_not be_empty
  end

  it "should default the port to the default_port before deploying" do
    subject.build!

    subject.deploy! do |exp|
      exp.port.should == 22
    end
  end
end
