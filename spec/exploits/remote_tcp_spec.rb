require 'ronin/exploits/remote_tcp'

require 'spec_helper'

describe Exploits::RemoteTCP do
  before(:all) do
    @exp = Exploits::RemoteTCP.new(
      :default_port => 22,
      :host => '127.0.0.1'
    )
  end

  it "should include the TCP Session module" do
    Exploits::RemoteTCP.include?(Sessions::TCP).should == true
  end

  it "should default the port to the default_port before deploying" do
    @exp.build!

    @exp.deploy! do |exp|
      exp.port.should == 22
    end
  end
end
