require 'spec_helper'
require 'ronin/exploits/remote_udp'

describe Exploits::RemoteUDP do
  before(:all) do
    @exploit = Exploits::RemoteUDP.new(
      :default_port => 22,
      :host => '127.0.0.1'
    )
  end

  it "should include the UDP Network helper module" do
    Exploits::RemoteUDP.should include(Network::Mixins::UDP)
  end

  it "should initialize all parameters by default" do
    @exploit.params.should_not be_empty
  end

  it "should default the port to the default_port before deploying" do
    @exploit.build!

    @exploit.deploy! do |exp|
      exp.port.should == 22
    end
  end
end
