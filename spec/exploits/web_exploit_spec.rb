require 'ronin/exploits/web_exploit'

require 'spec_helper'

describe Exploits::WebExploit do
  describe "targeted_url" do
    it "should create a targeted URL using the http_host param" do
      host = 'www.example.com'
      exploit = Exploits::WebExploit.new(:http_host => host)

      exploit.targeted_url.host.should == host
    end

    it "should create a targeted URL using the http_host param and the url_path property" do
      host = 'www.example.com'
      path = '/'
      exploit = Exploits::WebExploit.new(:http_host => host, :url_path => path)

      exploit.targeted_url.host.should == host
      exploit.targeted_url.path.should == path
    end

    it "should raise a MissingParam exception if http_host params is missing" do
      exploit = Exploits::WebExploit.new(:url_path => '/')

      lambda { exploit.targeted_url }.should raise_error(Parameters::MissingParam)
    end
  end
end
