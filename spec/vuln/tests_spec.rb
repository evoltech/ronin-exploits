require 'ronin/vuln/tests'

require 'spec_helper'

describe Vuln::Tests do
  before(:all) do
    class Vulnerable

      include Vuln::Tests

      vulnerable_to :test => :test1
      vulnerable_to :test_two => :test2

      def test1(options={})
        'test one'
      end

      def test2(options={})
        'test two'
      end

    end
  end

  it "should mark classes as being vulnerable" do
    Vulnerable.vulnerable_to?(:test).should == true
  end

  it "should have a hash of vuln names and test methods" do
    Vulnerable.vulns[:test].should == :test1
    Vulnerable.vulns[:test_two].should == :test2
  end

  it "should return the results of the vuln test methods for an object" do
    obj = Vulnerable.new

    obj.vulns.should == {:test => 'test one', :test_two => 'test two'}
  end
end
